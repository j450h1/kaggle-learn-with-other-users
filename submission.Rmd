---
title: "R Notebook"
output: html_notebook
---

```{python}
import pandas as pd
from pathlib import Path

file_to_open = Path.cwd() / "train.csv.zip"

df = pd.read_csv(file_to_open)

df.head()
```

```{python}
df.columns
```

* Eda

```{python}
df.shape
```


```{python}
df['Cover_Type'].unique() 
```



```{python}
df.groupby('Cover_Type')['Id'].count()
```


```{python}
len(df)/7
```

* Check for missing data

```{python}
df.columns[df.isnull().any()]
```

# Elevation
```{python}
df['Elevation'].hist()
```

```{python}
df['Elevation'].plot.box()
```

```{python}
df.boxplot(column=['Elevation'], by=['Cover_Type'])
```

```{python}
df.boxplot(column=['Aspect'], by=['Cover_Type'])
```

```{python}
df.boxplot(column=['Slope'], by=['Cover_Type'])
```

```{python}
df.boxplot(column=['Horizontal_Distance_To_Hydrology'], by=['Cover_Type'])
```

```{python}
df.boxplot(column=['Vertical_Distance_To_Hydrology'], by=['Cover_Type'])
```

```{python}
from statsmodels.graphics.mosaicplot import mosaic
plt.rcParams['font.size'] = 16.0
mosaic(df, ['Soil_Type1', 'Cover_Type']);
```

```{python}
import seaborn as sns
sns.catplot(x="Cover_Type", y="Soil_Type1", hue="class", kind="bar", data=df)
```

```{python}
# toy data
titanic = sns.load_dataset("titanic")
sns.catplot(x="sex", y="survived", hue="class", kind="bar", data=titanic);
```

```{python}
import seaborn as sns
sns.set(style="darkgrid")
ax = sns.countplot(x="Soil_Type1", data=df)
ax
```

```{python}
ax = sns.countplot(x="Cover_Type", hue="Soil_Type1", data=df); ax
```

```{python}
ax = sns.countplot(x="Cover_Type", hue="Wilderness_Area1", data=df); ax
```

# Horizontally

```{python}
ax = sns.countplot(y="Cover_Type", hue="Wilderness_Area1", data=df); ax
```

```{zsh}
ls
```

# Modeling

* Is there class imbalance?

```{python}
df['Cover_Type'].value_counts()
```

```{python}
# Import KFold
from sklearn.model_selection import KFold

# Create a KFold object
kf = KFold(n_splits=5, shuffle=True, random_state=123)

# Loop through each split
fold = 0
for train_index, test_index in kf.split(df):
    # Obtain training and testing folds
    cv_train, cv_test = df.iloc[train_index], df.iloc[test_index]
    print('Fold: {}'.format(fold))
    print('CV train shape: {}'.format(cv_train.shape))
    print('Cover Type = 5 in CV train: {}\n'.format(sum(cv_train.Cover_Type == 5))) # no need for Stratified since no class imbalance
    fold += 1
```

# Start with Logistic Regression
